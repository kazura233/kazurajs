"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5517],{8292:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>c});const l=JSON.parse('{"id":"web-daemon","title":"Web Daemon","description":"Web Daemon \u662f\u4e00\u4e2a\u7528\u4e8e\u521b\u5efa\u548c\u7ba1\u7406\u5b9a\u65f6\u4efb\u52a1\u7684\u5de5\u5177\u5305\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e00\u79cd\u7b80\u5355\u7684\u65b9\u5f0f\u6765\u5904\u7406\u9700\u8981\u5b9a\u671f\u6267\u884c\u7684\u4efb\u52a1\u3002","source":"@site/docs/web-daemon.md","sourceDirName":".","slug":"/web-daemon","permalink":"/kazurajs/docs/web-daemon","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/web-daemon.md","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"sidebar_position":10},"sidebar":"tutorialSidebar","previous":{"title":"Web Broadcast","permalink":"/kazurajs/docs/web-broadcast"},"next":{"title":"Web PostMsg","permalink":"/kazurajs/docs/web-postmsg"}}');var i=s(6106),d=s(8368);const a={sidebar_position:10},r="Web Daemon",o={},c=[{value:"\u7279\u6027",id:"\u7279\u6027",level:2},{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:2},{value:"\u4f7f\u7528\u65b9\u6cd5",id:"\u4f7f\u7528\u65b9\u6cd5",level:2},{value:"\u57fa\u672c\u7528\u6cd5",id:"\u57fa\u672c\u7528\u6cd5",level:3},{value:"\u9650\u5236\u6267\u884c\u6b21\u6570",id:"\u9650\u5236\u6267\u884c\u6b21\u6570",level:3},{value:"\u7acb\u5373\u6267\u884c",id:"\u7acb\u5373\u6267\u884c",level:3},{value:"API \u53c2\u8003",id:"api-\u53c2\u8003",level:2},{value:"\u6784\u9020\u51fd\u6570",id:"\u6784\u9020\u51fd\u6570",level:3},{value:"\u65b9\u6cd5",id:"\u65b9\u6cd5",level:3},{value:"\u9759\u6001\u65b9\u6cd5",id:"\u9759\u6001\u65b9\u6cd5",level:3},{value:"\u5c5e\u6027",id:"\u5c5e\u6027",level:3},{value:"\u6ce8\u610f\u4e8b\u9879",id:"\u6ce8\u610f\u4e8b\u9879",level:2},{value:"\u793a\u4f8b",id:"\u793a\u4f8b",level:2},{value:"\u8f6e\u8be2\u6570\u636e",id:"\u8f6e\u8be2\u6570\u636e",level:3},{value:"\u52a8\u753b\u6548\u679c",id:"\u52a8\u753b\u6548\u679c",level:3},{value:"\u5012\u8ba1\u65f6",id:"\u5012\u8ba1\u65f6",level:3}];function t(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"web-daemon",children:"Web Daemon"})}),"\n",(0,i.jsx)(n.p,{children:"Web Daemon \u662f\u4e00\u4e2a\u7528\u4e8e\u521b\u5efa\u548c\u7ba1\u7406\u5b9a\u65f6\u4efb\u52a1\u7684\u5de5\u5177\u5305\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e00\u79cd\u7b80\u5355\u7684\u65b9\u5f0f\u6765\u5904\u7406\u9700\u8981\u5b9a\u671f\u6267\u884c\u7684\u4efb\u52a1\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"\u7279\u6027",children:"\u7279\u6027"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u652f\u6301\u521b\u5efa\u5b9a\u65f6\u6267\u884c\u7684\u4efb\u52a1"}),"\n",(0,i.jsx)(n.li,{children:"\u53ef\u4ee5\u63a7\u5236\u4efb\u52a1\u7684\u6267\u884c\u9891\u7387\u548c\u603b\u6b21\u6570"}),"\n",(0,i.jsx)(n.li,{children:"\u652f\u6301\u6682\u505c\u548c\u6062\u590d\u4efb\u52a1"}),"\n",(0,i.jsx)(n.li,{children:"\u63d0\u4f9b\u5168\u5c40\u4efb\u52a1\u7ba1\u7406\u529f\u80fd"}),"\n",(0,i.jsx)(n.li,{children:"\u652f\u6301\u7acb\u5373\u6267\u884c\u4efb\u52a1"}),"\n",(0,i.jsx)(n.li,{children:"\u63d0\u4f9b\u5b8c\u6574\u7684 TypeScript \u7c7b\u578b\u652f\u6301"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install @kazura/web-daemon\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u4f7f\u7528\u65b9\u6cd5",children:"\u4f7f\u7528\u65b9\u6cd5"}),"\n",(0,i.jsx)(n.h3,{id:"\u57fa\u672c\u7528\u6cd5",children:"\u57fa\u672c\u7528\u6cd5"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import WebDaemon from '@kazura/web-daemon'\n\n// \u521b\u5efa\u4e00\u4e2a\u6bcf\u79d2\u6267\u884c\u4e00\u6b21\u7684\u4efb\u52a1\nconst daemon = new WebDaemon(\n  (next, daemon) => {\n    console.log('Task executed at index:', daemon.index)\n    next()\n  },\n  1000 // \u6267\u884c\u95f4\u9694\uff08\u6beb\u79d2\uff09\n)\n\n// \u542f\u52a8\u4efb\u52a1\ndaemon.start()\n\n// \u6682\u505c\u4efb\u52a1\ndaemon.pause()\n\n// \u6062\u590d\u4efb\u52a1\ndaemon.start()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u9650\u5236\u6267\u884c\u6b21\u6570",children:"\u9650\u5236\u6267\u884c\u6b21\u6570"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// \u521b\u5efa\u4e00\u4e2a\u53ea\u6267\u884c5\u6b21\u7684\u4efb\u52a1\nconst limitedDaemon = new WebDaemon(\n  (next, daemon) => {\n    console.log('Task executed at index:', daemon.index)\n    next()\n  },\n  1000,\n  5 // \u6700\u591a\u6267\u884c5\u6b21\n)\n\nlimitedDaemon.start()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u7acb\u5373\u6267\u884c",children:"\u7acb\u5373\u6267\u884c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const immediateDaemon = new WebDaemon((next, daemon) => {\n  console.log('Task executed at index:', daemon.index)\n  next()\n}, 1000)\n\n// \u542f\u52a8\u65f6\u7acb\u5373\u6267\u884c\u4e00\u6b21\ndaemon.start(true)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"api-\u53c2\u8003",children:"API \u53c2\u8003"}),"\n",(0,i.jsx)(n.h3,{id:"\u6784\u9020\u51fd\u6570",children:"\u6784\u9020\u51fd\u6570"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"constructor(\n  task: (next: () => void, daemon: WebDaemon) => void,\n  rate: number = 1000,\n  len: number = Number.POSITIVE_INFINITY\n)\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"task"}),": \u9700\u8981\u6267\u884c\u7684\u4efb\u52a1\u51fd\u6570"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"rate"}),": \u6267\u884c\u95f4\u9694\uff08\u6beb\u79d2\uff09\uff0c\u9ed8\u8ba4\u4e3a 1000"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"len"}),": \u6700\u5927\u6267\u884c\u6b21\u6570\uff0c\u9ed8\u8ba4\u4e3a\u65e0\u9650"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u65b9\u6cd5",children:"\u65b9\u6cd5"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"start(immediate: boolean = false): void"})," - \u542f\u52a8\u4efb\u52a1","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"immediate"}),": \u662f\u5426\u7acb\u5373\u6267\u884c\u4e00\u6b21"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"pause(): void"})," - \u6682\u505c\u4efb\u52a1"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"forceCall(): void"})," - \u5f3a\u5236\u6267\u884c\u4e00\u6b21\u4efb\u52a1"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"synchronize(): void"})," - \u540c\u6b65\u4efb\u52a1\u6267\u884c\u65f6\u95f4"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"isAtEnd(): boolean"})," - \u68c0\u67e5\u4efb\u52a1\u662f\u5426\u5df2\u7ed3\u675f"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u9759\u6001\u65b9\u6cd5",children:"\u9759\u6001\u65b9\u6cd5"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"pauseAll(): void"})," - \u6682\u505c\u6240\u6709\u8fd0\u884c\u4e2d\u7684\u4efb\u52a1"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u5c5e\u6027",children:"\u5c5e\u6027"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"index: number"})," - \u5f53\u524d\u6267\u884c\u6b21\u6570"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"len: number"})," - \u6700\u5927\u6267\u884c\u6b21\u6570"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"timer: number"})," - \u8ba1\u65f6\u5668\u6807\u8bc6"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"paused: boolean"})," - \u662f\u5426\u5904\u4e8e\u6682\u505c\u72b6\u6001"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u6ce8\u610f\u4e8b\u9879",children:"\u6ce8\u610f\u4e8b\u9879"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\u4efb\u52a1\u51fd\u6570\u5fc5\u987b\u8c03\u7528 ",(0,i.jsx)(n.code,{children:"next()"})," \u56de\u8c03\u6765\u7ee7\u7eed\u6267\u884c"]}),"\n",(0,i.jsxs)(n.li,{children:["\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"forceCall()"})," \u4f1a\u589e\u52a0 ",(0,i.jsx)(n.code,{children:"index"})," \u8ba1\u6570"]}),"\n",(0,i.jsx)(n.li,{children:"\u5f53\u4efb\u52a1\u8fbe\u5230\u6700\u5927\u6267\u884c\u6b21\u6570\u65f6\uff0c\u4f1a\u81ea\u52a8\u6682\u505c"}),"\n",(0,i.jsxs)(n.li,{children:["\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"pauseAll()"})," \u53ef\u4ee5\u4e00\u6b21\u6027\u6682\u505c\u6240\u6709\u8fd0\u884c\u4e2d\u7684\u4efb\u52a1"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u793a\u4f8b",children:"\u793a\u4f8b"}),"\n",(0,i.jsx)(n.h3,{id:"\u8f6e\u8be2\u6570\u636e",children:"\u8f6e\u8be2\u6570\u636e"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const pollingDaemon = new WebDaemon(\n  async (next, daemon) => {\n    try {\n      const response = await fetch('https://api.example.com/data')\n      const data = await response.json()\n      console.log('Polled data:', data)\n    } catch (error) {\n      console.error('Polling error:', error)\n    }\n    next()\n  },\n  5000 // \u6bcf5\u79d2\u8f6e\u8be2\u4e00\u6b21\n)\n\npollingDaemon.start()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u52a8\u753b\u6548\u679c",children:"\u52a8\u753b\u6548\u679c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const animationDaemon = new WebDaemon(\n  (next, daemon) => {\n    const progress = (daemon.index / 100) * 100\n    element.style.opacity = progress + '%'\n    if (progress >= 100) {\n      daemon.pause()\n    }\n    next()\n  },\n  16, // \u7ea660fps\n  100 // \u6267\u884c100\u6b21\n)\n\nanimationDaemon.start()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u5012\u8ba1\u65f6",children:"\u5012\u8ba1\u65f6"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const countdownDaemon = new WebDaemon(\n  (next, daemon) => {\n    const remaining = 10 - daemon.index\n    console.log(`Countdown: ${remaining}`)\n    if (remaining <= 0) {\n      daemon.pause()\n    }\n    next()\n  },\n  1000,\n  10\n)\n\ncountdownDaemon.start()\n"})})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(t,{...e})}):t(e)}},8368:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>r});var l=s(7378);const i={},d=l.createContext(i);function a(e){const n=l.useContext(d);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),l.createElement(d.Provider,{value:n},e.children)}}}]);