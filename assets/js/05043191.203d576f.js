"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[740],{3773:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>t,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"nestjs-winston","title":"NestJS Winston","description":"NestJS Winston \u662f\u4e00\u4e2a\u7528\u4e8e NestJS \u6846\u67b6\u7684 Winston \u65e5\u5fd7\u6a21\u5757\uff0c\u5b83\u63d0\u4f9b\u4e86\u5bf9 Winston \u65e5\u5fd7\u5e93\u7684\u7b80\u5355\u96c6\u6210\u548c\u914d\u7f6e\u3002","source":"@site/docs/nestjs-winston.md","sourceDirName":".","slug":"/nestjs-winston","permalink":"/kazurajs/docs/nestjs-winston","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/nestjs-winston.md","tags":[],"version":"current","sidebarPosition":18,"frontMatter":{"sidebar_position":18},"sidebar":"tutorialSidebar","previous":{"title":"NestJS Redis","permalink":"/kazurajs/docs/nestjs-redis"},"next":{"title":"HTTP Client","permalink":"/kazurajs/docs/http-client"}}');var i=s(6106),r=s(8784);const t={sidebar_position:18},l="NestJS Winston",c={},d=[{value:"\u7279\u6027",id:"\u7279\u6027",level:2},{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:2},{value:"\u4f7f\u7528\u65b9\u6cd5",id:"\u4f7f\u7528\u65b9\u6cd5",level:2},{value:"\u57fa\u672c\u7528\u6cd5",id:"\u57fa\u672c\u7528\u6cd5",level:3},{value:"\u4f7f\u7528\u81ea\u5b9a\u4e49\u5b9e\u4f8b",id:"\u4f7f\u7528\u81ea\u5b9a\u4e49\u5b9e\u4f8b",level:3},{value:"\u5f02\u6b65\u914d\u7f6e",id:"\u5f02\u6b65\u914d\u7f6e",level:3},{value:"API \u53c2\u8003",id:"api-\u53c2\u8003",level:2},{value:"WinstonModule",id:"winstonmodule",level:3},{value:"forRoot",id:"forroot",level:4},{value:"forRootAsync",id:"forrootasync",level:4},{value:"WinstonService",id:"winstonservice",level:3},{value:"getLogger",id:"getlogger",level:4},{value:"error",id:"error",level:4},{value:"warn",id:"warn",level:4},{value:"info",id:"info",level:4},{value:"debug",id:"debug",level:4},{value:"\u7c7b\u578b\u5b9a\u4e49",id:"\u7c7b\u578b\u5b9a\u4e49",level:2},{value:"WinstonModuleOptions",id:"winstonmoduleoptions",level:3},{value:"WinstonModuleAsyncOptions",id:"winstonmoduleasyncoptions",level:3},{value:"\u6ce8\u610f\u4e8b\u9879",id:"\u6ce8\u610f\u4e8b\u9879",level:2},{value:"\u793a\u4f8b",id:"\u793a\u4f8b",level:2},{value:"\u5728\u670d\u52a1\u4e2d\u4f7f\u7528\u65e5\u5fd7",id:"\u5728\u670d\u52a1\u4e2d\u4f7f\u7528\u65e5\u5fd7",level:3},{value:"\u4f7f\u7528\u81ea\u5b9a\u4e49\u683c\u5f0f",id:"\u4f7f\u7528\u81ea\u5b9a\u4e49\u683c\u5f0f",level:3},{value:"\u4f7f\u7528\u591a\u4e2a\u4f20\u8f93",id:"\u4f7f\u7528\u591a\u4e2a\u4f20\u8f93",level:3},{value:"\u4f7f\u7528\u5f02\u6b65\u914d\u7f6e",id:"\u4f7f\u7528\u5f02\u6b65\u914d\u7f6e",level:3}];function a(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"nestjs-winston",children:"NestJS Winston"})}),"\n",(0,i.jsx)(e.p,{children:"NestJS Winston \u662f\u4e00\u4e2a\u7528\u4e8e NestJS \u6846\u67b6\u7684 Winston \u65e5\u5fd7\u6a21\u5757\uff0c\u5b83\u63d0\u4f9b\u4e86\u5bf9 Winston \u65e5\u5fd7\u5e93\u7684\u7b80\u5355\u96c6\u6210\u548c\u914d\u7f6e\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"\u7279\u6027",children:"\u7279\u6027"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u652f\u6301 Winston \u7684\u6240\u6709\u529f\u80fd"}),"\n",(0,i.jsx)(e.li,{children:"\u652f\u6301\u540c\u6b65\u548c\u5f02\u6b65\u914d\u7f6e"}),"\n",(0,i.jsx)(e.li,{children:"\u63d0\u4f9b\u5b8c\u6574\u7684 TypeScript \u7c7b\u578b\u652f\u6301"}),"\n",(0,i.jsx)(e.li,{children:"\u652f\u6301\u81ea\u5b9a\u4e49\u65e5\u5fd7\u683c\u5f0f\u548c\u4f20\u8f93"}),"\n",(0,i.jsx)(e.li,{children:"\u63d0\u4f9b\u7b80\u5355\u7684\u65e5\u5fd7\u670d\u52a1\u63a5\u53e3"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"npm install @kazura/nestjs-winston\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u4f7f\u7528\u65b9\u6cd5",children:"\u4f7f\u7528\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.h3,{id:"\u57fa\u672c\u7528\u6cd5",children:"\u57fa\u672c\u7528\u6cd5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"import { Module } from '@nestjs/common'\nimport { WinstonModule } from '@kazura/nestjs-winston'\nimport * as winston from 'winston'\n\n@Module({\n  imports: [\n    WinstonModule.forRoot({\n      transports: [\n        new winston.transports.Console({\n          format: winston.format.combine(winston.format.timestamp(), winston.format.json()),\n        }),\n      ],\n    }),\n  ],\n})\nexport class AppModule {}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u4f7f\u7528\u81ea\u5b9a\u4e49\u5b9e\u4f8b",children:"\u4f7f\u7528\u81ea\u5b9a\u4e49\u5b9e\u4f8b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"import { Module } from '@nestjs/common'\nimport { WinstonModule } from '@kazura/nestjs-winston'\nimport * as winston from 'winston'\n\nconst logger = winston.createLogger({\n  level: 'info',\n  format: winston.format.json(),\n  transports: [\n    new winston.transports.File({ filename: 'error.log', level: 'error' }),\n    new winston.transports.File({ filename: 'combined.log' }),\n  ],\n})\n\n@Module({\n  imports: [\n    WinstonModule.forRoot({\n      instance: logger,\n    }),\n  ],\n})\nexport class AppModule {}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u5f02\u6b65\u914d\u7f6e",children:"\u5f02\u6b65\u914d\u7f6e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"import { Module } from '@nestjs/common'\nimport { WinstonModule } from '@kazura/nestjs-winston'\nimport { ConfigService } from '@nestjs/config'\n\n@Module({\n  imports: [\n    WinstonModule.forRootAsync({\n      imports: [ConfigModule],\n      useFactory: (configService: ConfigService) => ({\n        level: configService.get('LOG_LEVEL'),\n        format: winston.format.json(),\n        transports: [new winston.transports.Console()],\n      }),\n      inject: [ConfigService],\n    }),\n  ],\n})\nexport class AppModule {}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"api-\u53c2\u8003",children:"API \u53c2\u8003"}),"\n",(0,i.jsx)(e.h3,{id:"winstonmodule",children:"WinstonModule"}),"\n",(0,i.jsx)(e.h4,{id:"forroot",children:"forRoot"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"static forRoot(options: WinstonModuleOptions): DynamicModule\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u518c Winston \u6a21\u5757\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"options"}),": Winston \u914d\u7f6e\u9009\u9879"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u8fd4\u56de\u503c\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u52a8\u6001\u6a21\u5757"}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"forrootasync",children:"forRootAsync"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"static forRootAsync(options: WinstonModuleAsyncOptions): DynamicModule\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5f02\u6b65\u6ce8\u518c Winston \u6a21\u5757\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"options"}),": \u5f02\u6b65\u914d\u7f6e\u9009\u9879","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"imports"}),": \u5bfc\u5165\u7684\u6a21\u5757"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"useClass"}),": \u914d\u7f6e\u5de5\u5382\u7c7b"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"useFactory"}),": \u914d\u7f6e\u5de5\u5382\u51fd\u6570"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"inject"}),": \u6ce8\u5165\u7684\u4f9d\u8d56"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u8fd4\u56de\u503c\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u52a8\u6001\u6a21\u5757"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"winstonservice",children:"WinstonService"}),"\n",(0,i.jsx)(e.h4,{id:"getlogger",children:"getLogger"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"getLogger(): Logger\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u83b7\u53d6 Winston \u65e5\u5fd7\u5b9e\u4f8b\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u8fd4\u56de\u503c\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Winston \u65e5\u5fd7\u5b9e\u4f8b"}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"error",children:"error"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"error(message: string, data: any): void\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8bb0\u5f55\u9519\u8bef\u65e5\u5fd7\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"message"}),": \u65e5\u5fd7\u6d88\u606f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"data"}),": \u65e5\u5fd7\u6570\u636e"]}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"warn",children:"warn"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"warn(message: string, data: any): void\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8bb0\u5f55\u8b66\u544a\u65e5\u5fd7\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"message"}),": \u65e5\u5fd7\u6d88\u606f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"data"}),": \u65e5\u5fd7\u6570\u636e"]}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"info",children:"info"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"info(message: string, data: any): void\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8bb0\u5f55\u4fe1\u606f\u65e5\u5fd7\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"message"}),": \u65e5\u5fd7\u6d88\u606f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"data"}),": \u65e5\u5fd7\u6570\u636e"]}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"debug",children:"debug"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"debug(message: string, data: any): void\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8bb0\u5f55\u8c03\u8bd5\u65e5\u5fd7\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"message"}),": \u65e5\u5fd7\u6d88\u606f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"data"}),": \u65e5\u5fd7\u6570\u636e"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u7c7b\u578b\u5b9a\u4e49",children:"\u7c7b\u578b\u5b9a\u4e49"}),"\n",(0,i.jsx)(e.h3,{id:"winstonmoduleoptions",children:"WinstonModuleOptions"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"interface WinstonModuleOptions extends LoggerOptions {\n  instance?: Logger\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"winstonmoduleasyncoptions",children:"WinstonModuleAsyncOptions"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"interface WinstonModuleAsyncOptions extends Pick<ModuleMetadata, 'imports'> {\n  useClass?: Type<WinstonOptionsFactory>\n  useFactory?: (...args: any[]) => Promise<WinstonModuleOptions> | WinstonModuleOptions\n  inject?: any[]\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u6ce8\u610f\u4e8b\u9879",children:"\u6ce8\u610f\u4e8b\u9879"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u786e\u4fdd\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u914d\u7f6e\u9002\u5f53\u7684\u65e5\u5fd7\u7ea7\u522b"}),"\n",(0,i.jsx)(e.li,{children:"\u8003\u8651\u4f7f\u7528\u6587\u4ef6\u4f20\u8f93\u6765\u6301\u4e45\u5316\u65e5\u5fd7"}),"\n",(0,i.jsx)(e.li,{children:"\u53ef\u4ee5\u4f7f\u7528\u81ea\u5b9a\u4e49\u683c\u5f0f\u6765\u6ee1\u8db3\u7279\u5b9a\u7684\u65e5\u5fd7\u9700\u6c42"}),"\n",(0,i.jsx)(e.li,{children:"\u5efa\u8bae\u4f7f\u7528\u5f02\u6b65\u914d\u7f6e\u6765\u7ba1\u7406\u65e5\u5fd7\u914d\u7f6e"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u793a\u4f8b",children:"\u793a\u4f8b"}),"\n",(0,i.jsx)(e.h3,{id:"\u5728\u670d\u52a1\u4e2d\u4f7f\u7528\u65e5\u5fd7",children:"\u5728\u670d\u52a1\u4e2d\u4f7f\u7528\u65e5\u5fd7"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"import { Injectable } from '@nestjs/common'\nimport { WinstonService } from '@kazura/nestjs-winston'\n\n@Injectable()\nexport class UserService {\n  constructor(private readonly logger: WinstonService) {}\n\n  async createUser(userData: any) {\n    try {\n      // \u521b\u5efa\u7528\u6237\u903b\u8f91...\n      this.logger.info('User created successfully', { userId: '123' })\n    } catch (error) {\n      this.logger.error('Failed to create user', { error, userData })\n      throw error\n    }\n  }\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u4f7f\u7528\u81ea\u5b9a\u4e49\u683c\u5f0f",children:"\u4f7f\u7528\u81ea\u5b9a\u4e49\u683c\u5f0f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"import { Module } from '@nestjs/common'\nimport { WinstonModule } from '@kazura/nestjs-winston'\nimport * as winston from 'winston'\n\n@Module({\n  imports: [\n    WinstonModule.forRoot({\n      format: winston.format.combine(\n        winston.format.timestamp(),\n        winston.format.colorize(),\n        winston.format.printf(({ timestamp, level, message, ...meta }) => {\n          return `${timestamp} [${level}]: ${message} ${\n            Object.keys(meta).length ? JSON.stringify(meta) : ''\n          }`\n        })\n      ),\n      transports: [new winston.transports.Console()],\n    }),\n  ],\n})\nexport class AppModule {}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u4f7f\u7528\u591a\u4e2a\u4f20\u8f93",children:"\u4f7f\u7528\u591a\u4e2a\u4f20\u8f93"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"import { Module } from '@nestjs/common'\nimport { WinstonModule } from '@kazura/nestjs-winston'\nimport * as winston from 'winston'\n\n@Module({\n  imports: [\n    WinstonModule.forRoot({\n      transports: [\n        new winston.transports.Console({\n          level: 'info',\n        }),\n        new winston.transports.File({\n          filename: 'error.log',\n          level: 'error',\n        }),\n        new winston.transports.File({\n          filename: 'combined.log',\n        }),\n      ],\n    }),\n  ],\n})\nexport class AppModule {}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u4f7f\u7528\u5f02\u6b65\u914d\u7f6e",children:"\u4f7f\u7528\u5f02\u6b65\u914d\u7f6e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"import { Module } from '@nestjs/common'\nimport { WinstonModule } from '@kazura/nestjs-winston'\nimport { ConfigModule, ConfigService } from '@nestjs/config'\nimport * as winston from 'winston'\n\n@Module({\n  imports: [\n    ConfigModule.forRoot(),\n    WinstonModule.forRootAsync({\n      imports: [ConfigModule],\n      useFactory: (configService: ConfigService) => ({\n        level: configService.get('LOG_LEVEL', 'info'),\n        format: winston.format.combine(winston.format.timestamp(), winston.format.json()),\n        transports: [\n          new winston.transports.Console(),\n          new winston.transports.File({\n            filename: configService.get('LOG_FILE', 'app.log'),\n          }),\n        ],\n      }),\n      inject: [ConfigService],\n    }),\n  ],\n})\nexport class AppModule {}\n"})})]})}function p(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(a,{...n})}):a(n)}},8784:(n,e,s)=>{s.d(e,{R:()=>t,x:()=>l});var o=s(7378);const i={},r=o.createContext(i);function t(n){const e=o.useContext(r);return o.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:t(n.components),o.createElement(r.Provider,{value:e},n.children)}}}]);