"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[3706],{1880:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"taro-storage","title":"Taro Storage","description":"Taro Storage \u662f\u4e00\u4e2a\u4e3a Taro \u5e94\u7528\u63d0\u4f9b\u672c\u5730\u5b58\u50a8\u529f\u80fd\u7684\u5de5\u5177\u5305\uff0c\u5b83\u5b9e\u73b0\u4e86 Web Storage API \u7684\u63a5\u53e3\uff0c\u5e76\u63d0\u4f9b\u4e86\u989d\u5916\u7684\u529f\u80fd\u3002","source":"@site/docs/taro-storage.md","sourceDirName":".","slug":"/taro-storage","permalink":"/kazurajs/docs/taro-storage","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/taro-storage.md","tags":[],"version":"current","sidebarPosition":23,"frontMatter":{"sidebar_position":23},"sidebar":"tutorialSidebar","previous":{"title":"Vite Config","permalink":"/kazurajs/docs/vite-config"},"next":{"title":"Lock Native Back","permalink":"/kazurajs/docs/lock-native-back"}}');var a=t(6106),s=t(1427);const i={sidebar_position:23},l="Taro Storage",o={},c=[{value:"\u7279\u6027",id:"\u7279\u6027",level:2},{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:2},{value:"\u4f7f\u7528\u65b9\u6cd5",id:"\u4f7f\u7528\u65b9\u6cd5",level:2},{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528",level:3},{value:"\u4f7f\u7528\u952e\u503c\u5bf9",id:"\u4f7f\u7528\u952e\u503c\u5bf9",level:3},{value:"API \u53c2\u8003",id:"api-\u53c2\u8003",level:2},{value:"length",id:"length",level:3},{value:"clear",id:"clear",level:3},{value:"getItem",id:"getitem",level:3},{value:"setItem",id:"setitem",level:3},{value:"removeItem",id:"removeitem",level:3},{value:"key",id:"key",level:3},{value:"all",id:"all",level:3},{value:"\u6ce8\u610f\u4e8b\u9879",id:"\u6ce8\u610f\u4e8b\u9879",level:2},{value:"\u793a\u4f8b",id:"\u793a\u4f8b",level:2},{value:"\u5b58\u50a8\u7528\u6237\u4fe1\u606f",id:"\u5b58\u50a8\u7528\u6237\u4fe1\u606f",level:3},{value:"\u7ba1\u7406\u5e94\u7528\u8bbe\u7f6e",id:"\u7ba1\u7406\u5e94\u7528\u8bbe\u7f6e",level:3},{value:"\u7f13\u5b58 API \u54cd\u5e94",id:"\u7f13\u5b58-api-\u54cd\u5e94",level:3},{value:"\u7ba1\u7406\u8d2d\u7269\u8f66",id:"\u7ba1\u7406\u8d2d\u7269\u8f66",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"taro-storage",children:"Taro Storage"})}),"\n",(0,a.jsx)(n.p,{children:"Taro Storage \u662f\u4e00\u4e2a\u4e3a Taro \u5e94\u7528\u63d0\u4f9b\u672c\u5730\u5b58\u50a8\u529f\u80fd\u7684\u5de5\u5177\u5305\uff0c\u5b83\u5b9e\u73b0\u4e86 Web Storage API \u7684\u63a5\u53e3\uff0c\u5e76\u63d0\u4f9b\u4e86\u989d\u5916\u7684\u529f\u80fd\u3002"}),"\n",(0,a.jsx)(n.h2,{id:"\u7279\u6027",children:"\u7279\u6027"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u5b9e\u73b0 Web Storage API \u63a5\u53e3"}),"\n",(0,a.jsx)(n.li,{children:"\u652f\u6301\u540c\u6b65\u5b58\u50a8\u64cd\u4f5c"}),"\n",(0,a.jsx)(n.li,{children:"\u63d0\u4f9b\u83b7\u53d6\u6240\u6709\u5b58\u50a8\u9879\u7684\u529f\u80fd"}),"\n",(0,a.jsx)(n.li,{children:"\u7c7b\u578b\u5b89\u5168\u7684 API"}),"\n",(0,a.jsx)(n.li,{children:"\u8f7b\u91cf\u7ea7\uff0c\u65e0\u4f9d\u8d56"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"npm install @kazura/taro-storage\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u4f7f\u7528\u65b9\u6cd5",children:"\u4f7f\u7528\u65b9\u6cd5"}),"\n",(0,a.jsx)(n.h3,{id:"\u57fa\u672c\u4f7f\u7528",children:"\u57fa\u672c\u4f7f\u7528"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"import taroStorage from '@kazura/taro-storage'\n\n// \u5b58\u50a8\u6570\u636e\ntaroStorage.setItem('user', JSON.stringify({ name: 'John', age: 30 }))\n\n// \u83b7\u53d6\u6570\u636e\nconst user = JSON.parse(taroStorage.getItem('user') || '{}')\n\n// \u5220\u9664\u6570\u636e\ntaroStorage.removeItem('user')\n\n// \u6e05\u7a7a\u6240\u6709\u6570\u636e\ntaroStorage.clear()\n\n// \u83b7\u53d6\u6240\u6709\u5b58\u50a8\u9879\nconst allItems = taroStorage.all()\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u4f7f\u7528\u952e\u503c\u5bf9",children:"\u4f7f\u7528\u952e\u503c\u5bf9"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"import taroStorage from '@kazura/taro-storage'\n\n// \u5b58\u50a8\u591a\u4e2a\u503c\ntaroStorage.setItem('name', 'John')\ntaroStorage.setItem('age', '30')\ntaroStorage.setItem('email', 'john@example.com')\n\n// \u83b7\u53d6\u7279\u5b9a\u952e\u7684\u503c\nconst name = taroStorage.getItem('name')\nconst age = taroStorage.getItem('age')\n\n// \u83b7\u53d6\u5b58\u50a8\u9879\u6570\u91cf\nconst length = taroStorage.length\n\n// \u83b7\u53d6\u6307\u5b9a\u7d22\u5f15\u7684\u952e\nconst key = taroStorage.key(0)\n"})}),"\n",(0,a.jsx)(n.h2,{id:"api-\u53c2\u8003",children:"API \u53c2\u8003"}),"\n",(0,a.jsx)(n.h3,{id:"length",children:"length"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"get length(): number\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u83b7\u53d6\u5b58\u50a8\u9879\u7684\u6570\u91cf\u3002"}),"\n",(0,a.jsx)(n.h3,{id:"clear",children:"clear"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"clear(): void\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u6e05\u7a7a\u6240\u6709\u5b58\u50a8\u9879\u3002"}),"\n",(0,a.jsx)(n.h3,{id:"getitem",children:"getItem"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"getItem(key: string): string | null\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u83b7\u53d6\u6307\u5b9a\u952e\u7684\u5b58\u50a8\u503c\u3002"}),"\n",(0,a.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"key"}),": \u5b58\u50a8\u952e\u540d"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"\u8fd4\u56de\u503c\uff1a"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u5b58\u50a8\u7684\u503c\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5219\u8fd4\u56de null"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"setitem",children:"setItem"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"setItem(key: string, value: string): void\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u8bbe\u7f6e\u6307\u5b9a\u952e\u7684\u5b58\u50a8\u503c\u3002"}),"\n",(0,a.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"key"}),": \u5b58\u50a8\u952e\u540d"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"value"}),": \u8981\u5b58\u50a8\u7684\u503c"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"removeitem",children:"removeItem"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"removeItem(key: string): void\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u5220\u9664\u6307\u5b9a\u952e\u7684\u5b58\u50a8\u9879\u3002"}),"\n",(0,a.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"key"}),": \u8981\u5220\u9664\u7684\u5b58\u50a8\u952e\u540d"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"key",children:"key"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"key(index: number): string | null\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u83b7\u53d6\u6307\u5b9a\u7d22\u5f15\u7684\u5b58\u50a8\u952e\u540d\u3002"}),"\n",(0,a.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"index"}),": \u952e\u7684\u7d22\u5f15"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"\u8fd4\u56de\u503c\uff1a"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u5b58\u50a8\u952e\u540d\uff0c\u5982\u679c\u7d22\u5f15\u8d85\u51fa\u8303\u56f4\u5219\u8fd4\u56de null"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"all",children:"all"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"all(): { [key: string]: any }\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u83b7\u53d6\u6240\u6709\u5b58\u50a8\u9879\u3002"}),"\n",(0,a.jsx)(n.p,{children:"\u8fd4\u56de\u503c\uff1a"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u5305\u542b\u6240\u6709\u5b58\u50a8\u9879\u7684\u5bf9\u8c61"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"\u6ce8\u610f\u4e8b\u9879",children:"\u6ce8\u610f\u4e8b\u9879"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"\u6240\u6709\u5b58\u50a8\u64cd\u4f5c\u90fd\u662f\u540c\u6b65\u7684"}),"\n",(0,a.jsx)(n.li,{children:"\u5b58\u50a8\u7684\u503c\u5fc5\u987b\u662f\u5b57\u7b26\u4e32"}),"\n",(0,a.jsx)(n.li,{children:"\u5b58\u50a8\u7a7a\u95f4\u6709\u9650\uff0c\u5efa\u8bae\u53ca\u65f6\u6e05\u7406\u4e0d\u9700\u8981\u7684\u6570\u636e"}),"\n",(0,a.jsx)(n.li,{children:"\u5728\u5b58\u50a8\u5bf9\u8c61\u65f6\uff0c\u9700\u8981\u5148\u8fdb\u884c JSON \u5e8f\u5217\u5316"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"\u793a\u4f8b",children:"\u793a\u4f8b"}),"\n",(0,a.jsx)(n.h3,{id:"\u5b58\u50a8\u7528\u6237\u4fe1\u606f",children:"\u5b58\u50a8\u7528\u6237\u4fe1\u606f"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"import taroStorage from '@kazura/taro-storage'\n\ninterface UserInfo {\n  id: string\n  name: string\n  email: string\n  preferences: {\n    theme: 'light' | 'dark'\n    language: string\n  }\n}\n\n// \u5b58\u50a8\u7528\u6237\u4fe1\u606f\nconst userInfo: UserInfo = {\n  id: '123',\n  name: 'John Doe',\n  email: 'john@example.com',\n  preferences: {\n    theme: 'light',\n    language: 'en',\n  },\n}\n\ntaroStorage.setItem('userInfo', JSON.stringify(userInfo))\n\n// \u83b7\u53d6\u7528\u6237\u4fe1\u606f\nconst storedUserInfo = JSON.parse(taroStorage.getItem('userInfo') || '{}') as UserInfo\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u7ba1\u7406\u5e94\u7528\u8bbe\u7f6e",children:"\u7ba1\u7406\u5e94\u7528\u8bbe\u7f6e"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"import taroStorage from '@kazura/taro-storage'\n\ninterface AppSettings {\n  theme: 'light' | 'dark'\n  fontSize: number\n  notifications: boolean\n}\n\n// \u521d\u59cb\u5316\u9ed8\u8ba4\u8bbe\u7f6e\nconst defaultSettings: AppSettings = {\n  theme: 'light',\n  fontSize: 14,\n  notifications: true,\n}\n\n// \u4fdd\u5b58\u8bbe\u7f6e\nfunction saveSettings(settings: AppSettings) {\n  taroStorage.setItem('appSettings', JSON.stringify(settings))\n}\n\n// \u52a0\u8f7d\u8bbe\u7f6e\nfunction loadSettings(): AppSettings {\n  const stored = taroStorage.getItem('appSettings')\n  return stored ? JSON.parse(stored) : defaultSettings\n}\n\n// \u91cd\u7f6e\u8bbe\u7f6e\nfunction resetSettings() {\n  taroStorage.removeItem('appSettings')\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u7f13\u5b58-api-\u54cd\u5e94",children:"\u7f13\u5b58 API \u54cd\u5e94"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"import taroStorage from '@kazura/taro-storage'\n\ninterface CacheItem<T> {\n  data: T\n  timestamp: number\n  expiresIn: number\n}\n\n// \u7f13\u5b58\u6570\u636e\nfunction cacheData<T>(key: string, data: T, expiresIn: number = 3600000) {\n  const cacheItem: CacheItem<T> = {\n    data,\n    timestamp: Date.now(),\n    expiresIn,\n  }\n  taroStorage.setItem(key, JSON.stringify(cacheItem))\n}\n\n// \u83b7\u53d6\u7f13\u5b58\u6570\u636e\nfunction getCachedData<T>(key: string): T | null {\n  const stored = taroStorage.getItem(key)\n  if (!stored) return null\n\n  const cacheItem = JSON.parse(stored) as CacheItem<T>\n  const now = Date.now()\n\n  if (now - cacheItem.timestamp > cacheItem.expiresIn) {\n    taroStorage.removeItem(key)\n    return null\n  }\n\n  return cacheItem.data\n}\n\n// \u4f7f\u7528\u793a\u4f8b\nconst apiData = { users: ['John', 'Jane'] }\ncacheData('api/users', apiData)\n\nconst cachedData = getCachedData<typeof apiData>('api/users')\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u7ba1\u7406\u8d2d\u7269\u8f66",children:"\u7ba1\u7406\u8d2d\u7269\u8f66"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"import taroStorage from '@kazura/taro-storage'\n\ninterface CartItem {\n  id: string\n  name: string\n  price: number\n  quantity: number\n}\n\n// \u6dfb\u52a0\u5546\u54c1\u5230\u8d2d\u7269\u8f66\nfunction addToCart(item: CartItem) {\n  const cart = JSON.parse(taroStorage.getItem('cart') || '[]') as CartItem[]\n  const existingItem = cart.find((i) => i.id === item.id)\n\n  if (existingItem) {\n    existingItem.quantity += item.quantity\n  } else {\n    cart.push(item)\n  }\n\n  taroStorage.setItem('cart', JSON.stringify(cart))\n}\n\n// \u4ece\u8d2d\u7269\u8f66\u79fb\u9664\u5546\u54c1\nfunction removeFromCart(itemId: string) {\n  const cart = JSON.parse(taroStorage.getItem('cart') || '[]') as CartItem[]\n  const updatedCart = cart.filter((item) => item.id !== itemId)\n  taroStorage.setItem('cart', JSON.stringify(updatedCart))\n}\n\n// \u6e05\u7a7a\u8d2d\u7269\u8f66\nfunction clearCart() {\n  taroStorage.removeItem('cart')\n}\n\n// \u83b7\u53d6\u8d2d\u7269\u8f66\u603b\u4ef7\nfunction getCartTotal(): number {\n  const cart = JSON.parse(taroStorage.getItem('cart') || '[]') as CartItem[]\n  return cart.reduce((total, item) => total + item.price * item.quantity, 0)\n}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},1427:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>l});var r=t(7378);const a={},s=r.createContext(a);function i(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);